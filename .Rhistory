ggplot2::theme_classic()
ggpl
getwd()
out.dir <- "C:/Users/cbroeckl/OneDrive - Colostate/ARC/manuscripts/20250721_pubchem.bio/"
ggpl <- ggplot2::ggplot(pc.bio.salsa, ggplot2::aes(taxonomy.lca.similarity.aggregate)) +
ggplot2::geom_histogram(color = "#000000", fill = "#1E4D2B") +
ggplot2::theme_classic()
ggplot2::ggsave(ggpl, file = "salsa.score.histogram.eps", scale = 0.75)
ggplot2::ggsave(ggpl, file = paste0(out.dir, "salsa.score.histogram.eps", scale = 0.75))
ggpl
ggplot2::ggsave(ggpl, file = paste0(out.dir, "salsa.score.histogram.eps", scale = 0.75))
out.dir <- "C:/Users/cbroeckl/OneDrive - Colostate/ARC/manuscripts/20250721_pubchem.bio/"
out.dir
ggplot2::ggsave(ggpl, file = paste0(out.dir, "salsa.score.histogram.eps"), scale = 0.75)
cids <- c(174174, 1548943) #atropine, capsaicin
cid.lca[cid.lca$cid %in% cids,]
load(paste0(local.pubchem.directory, "/cid.accurate.mass.Rdata"))
pc.mw <- ggplot2::ggplot(cid.accurate.mass, ggplot2::aes(exact.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B") +
ggplot2::theme_classic()
pc.mw
pc.mw <- ggplot2::ggplot(cid.accurate.mass, ggplot2::aes(exact.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B") +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000))
pc.mw
in.bio <- pc.bio$cid %in% cid.accurate.mass$cid
is.primary <- primary.metabolome$cid %in% cid.accurate.mass$cid
pc.mw <- ggplot2::ggplot(cid.accurate.mass, ggplot2::aes(exact.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 10) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000))
pc.mw
pc.mw <- ggplot2::ggplot(cid.accurate.mass, ggplot2::aes(exact.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000))
pc.mw
pc.mw.bio <- ggplot2::ggplot(cid.accurate.mass[in.bio,], ggplot2::aes(exact.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000))
pc.mw.bio <- ggplot2::ggplot(pc.bio, ggplot2::aes(monoisotopic.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000))
pc.mw.bio
pc.mw.prim <- ggplot2::ggplot(primary.metabolome, ggplot2::aes(monoisotopic.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000))
pc.mw.prim
pc.mw <- ggplot2::ggplot(cid.accurate.mass, ggplot2::aes(exact.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000)) +
ggplot2::ggtitle("all PubChem")
pc.mw
load(paste0(local.pubchem.directory, "/cid.monoisotopic.mass.Rdata"))
rm(cid.accurate.mass)
gc()
pc.mw.bio <- ggplot2::ggplot(pc.bio, ggplot2::aes(monoisotopic.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000))
pc.mw.bio
pc.mw.prim <- ggplot2::ggplot(primary.metabolome, ggplot2::aes(monoisotopic.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000)) +
ggplot2::xlab("monoisotopic mass")
pc.mw.prim
primary.metabolome$monoisotopic.mass
head(pc.bio$monoisotopic.mass)
which(is.na(pc.bio$monoisotopic.mass))
source("C:/Users/cbroeckl/Documents/GitHub/pubchem.bio/R/build.primary.metabolome.R")
primary.metabolome <- build.primary.metabolome(pc.directory = local.pubchem.directory, get.properties = FALSE, min.tax.ct = 250, keep.primary.only = TRUE)
dim(primary.metabolome)
source("C:/Users/cbroeckl/Documents/GitHub/pubchem.bio/R/build.primary.metabolome.R")
primary.metabolome <- build.primary.metabolome(pc.directory = local.pubchem.directory, get.properties = FALSE, min.tax.ct = 250, keep.primary.only = TRUE)
dim(primary.metabolome)
head(pubchem.bio)
dim(pc.bio.salsa)
names(pc.bio.salsa)
names(pubchem.bio)
names(pc.bio)
names(primary.metabolome)
pc.directory
pc.directory <- local.pubchem.directory
rm(pc.bio)
rm(pubchem.bio)
load(paste0(pc.directory, "/pc.bio.Rdata"))
source("C:/Users/cbroeckl/Documents/GitHub/pubchem.bio/R/build.primary.metabolome.R")
primary.metabolome <- build.primary.metabolome(
pc.directory = local.pubchem.directory, get.properties = FALSE,
min.tax.ct = 250, keep.primary.only = TRUE)
dim(primary.metabolome)
head(primary.metabolome)
which(primary.metabolome$lca == 1)
source("C:/Users/cbroeckl/Documents/GitHub/pubchem.bio/R/build.primary.metabolome.R")
out <- pc.bio
keep <- which(out$lca == 1 & out$taxonomy.ct >= min.tax.ct)
min.tax.ct <- 100
keep <- which(out$lca == 1 & out$taxonomy.ct >= min.tax.ct)
keep
keep.primary.only
keep.primary.only <- TRUE
if(keep.primary.only) {
out <- out[keep,]
}
dim(out)
source("C:/Users/cbroeckl/Documents/GitHub/pubchem.bio/R/build.primary.metabolome.R")
rm(out)
rm(min.tax.ct)
rm(keep)
rm(keep.porimary.only)
rm(keep.primary.only)
primary.metabolome <- build.primary.metabolome(
pc.directory = local.pubchem.directory, get.properties = FALSE,
min.tax.ct = 250, keep.primary.only = TRUE)
dim(primary.metabolome)
primary.metabolome <- build.primary.metabolome(
pc.directory = local.pubchem.directory, get.properties = FALSE,
min.tax.ct = 50, keep.primary.only = TRUE)
dim(primary.metabolome)
pc.mw.prim <- ggplot2::ggplot(primary.metabolome, ggplot2::aes(monoisotopic.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000)) +
ggplot2::xlab("monoisotopic mass")
pc.mw.prim
which(is.na(primary.metabolome$monoisotopic.mass))
2^1:10
n.tax <- 2^(1:10)
n.tax
n.tax <- 2^(0:10)
n.mets <- rep(NA, length(n.tax))
nrow(primary.metabolome)
n.tax <- 2^(0:10)
n.mets <- rep(NA, length(n.tax))
for(i in 1:length(n.tax)) {
tmp <- build.primary.metabolome(
pc.directory = local.pubchem.directory, get.properties = FALSE,
min.tax.ct = n.tax[i], keep.primary.only = TRUE)
n.mets[i] <- nrow(tmp)
rm(tmp); gc()
}
n.mets
plot(n.mets)
rarefaction <- data.frame(
taxa.count = n.tax,
primary.metabolotes = n.mets
)
ggplot(rarefaction, aes(x=taxa.count, y=primary.metabolites)) +
geom_line() +
geom_point(size=1) +
scale_x_continuous(
trans = "log2",
labels = scales::math_format(2^.x, format = log2)
)
ggplot2::ggplot(rarefaction, aes(x=taxa.count, y=primary.metabolites)) +
geom_line() +
geom_point(size=1) +
scale_x_continuous(
trans = "log2",
labels = scales::math_format(2^.x, format = log2)
)
ggplot2::ggplot(rarefaction, ggplot2::aes(x=taxa.count, y=primary.metabolites)) +
geom_line() +
geom_point(size=1) +
scale_x_continuous(
trans = "log2",
labels = scales::math_format(2^.x, format = log2)
)
ggplot2::ggplot(rarefaction, ggplot2::aes(x=taxa.count, y=primary.metabolites)) +
ggplot2::geom_line() +
ggplot2::geom_point(size=1) +
ggplot2::scale_x_continuous(
trans = "log2",
labels = scales::math_format(2^.x, format = log2)
)
rarefaction <- data.frame(
taxa.count = n.tax,
primary.metabolites = n.mets
)
ggplot2::ggplot(rarefaction, ggplot2::aes(x=taxa.count, y=primary.metabolites)) +
ggplot2::geom_line() +
ggplot2::geom_point(size=1) +
ggplot2::scale_x_continuous(
trans = "log2",
labels = scales::math_format(2^.x, format = log2)
)
ggplot2::ggplot(rarefaction, ggplot2::aes(x=taxa.count, y=primary.metabolites)) +
ggplot2::geom_line() +
ggplot2::geom_point(size=1) +
ggplot2::scale_x_continuous(
trans = "log2",
labels = scales::math_format(2^.x, format = log2)
) +
ggplot2::theme_classic() +
hist(core.metabolome$monoisotopic.mass)
ggplot2::ggplot(rarefaction, ggplot2::aes(x=taxa.count, y=primary.metabolites)) +
ggplot2::geom_line() +
ggplot2::geom_point(size=1) +
ggplot2::scale_x_continuous(
trans = "log2",
labels = scales::math_format(2^.x, format = log2)
) +
ggplot2::theme_classic() +
ggplot2::ggplot(rarefaction, ggplot2::aes(x=taxa.count, y=primary.metabolites)) +
ggplot2::geom_line() +
ggplot2::geom_point(size=1) +
ggplot2::scale_x_continuous(
trans = "log2",
labels = scales::math_format(2^.x, format = log2)
) +
ggplot2::theme_classic()
ggplot2::ggplot(rarefaction, ggplot2::aes(x=taxa.count, y=primary.metabolites)) +
ggplot2::geom_line() +
ggplot2::geom_point(size=2) +
ggplot2::scale_x_continuous(
trans = "log2",
labels = scales::math_format(2^.x, format = log2)
) +
ggplot2::theme_classic()
ggplot2::ggplot(rarefaction, ggplot2::aes(x=taxa.count, y=primary.metabolites)) +
ggplot2::geom_line() +
ggplot2::geom_point(size=2) +
ggplot2::scale_x_continuous(
trans = "log2",
labels = scales::math_format(2^.x, format = log2),
size = 2
) +
ggplot2::theme_classic()
pc.prim.curve <- ggplot2::ggplot(rarefaction, ggplot2::aes(x=taxa.count, y=primary.metabolites)) +
ggplot2::geom_line() +
ggplot2::geom_point(size=2) +
ggplot2::scale_x_continuous(
trans = "log2",
labels = scales::math_format(2^.x, format = log2)
) +
ggplot2::theme_classic()
pc.mw.bio/pc.mw.prim
pc.mw.bio / pc.mw.prim
p1 <- gtable::ggplotBrob(pc.mw)
p1 <- gtable::ggplotGrob(pc.mw)
?gridExtra::grid.arrange()
p1 <- pc.mw
p2 <- pc.mw.bio
p3 <- pc.prim.curve
p4 <- pc.mw.prim
gridExtra::grid.arrange(p1,p2,p3,p4)
2^8
pc.mw <- ggplot2::ggplot(cid.accurate.mass, ggplot2::aes(exact.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000))
pc.mw.bio <- ggplot2::ggplot(pc.bio, ggplot2::aes(monoisotopic.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000))
pc.mw.prim <- ggplot2::ggplot(primary.metabolome, ggplot2::aes(monoisotopic.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000)) +
ggplot2::xlab("monoisotopic mass")
pc.prim.curve <- ggplot2::ggplot(rarefaction, ggplot2::aes(x=taxa.count, y=primary.metabolites)) +
ggplot2::geom_line() +
ggplot2::geom_point(size=2) +
ggplot2::scale_x_continuous(
trans = "log2",
labels = scales::math_format(2^.x, format = log2)
) +
ggplot2::theme_classic()
fig.2 <- gridExtra::grid.arrange(p1,p2,p3,p4)
ggplot2::ggsave(fig.2, file = paste0(out.dir, "mw.distribution.eps"), scale = 1.25)
pc.mw <- ggplot2::ggplot(cid.accurate.mass, ggplot2::aes(exact.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000))
pc.mw
p1 <- pc.mw
fig.2 <- gridExtra::grid.arrange(
arrangeGrob(p1, left = textGrob("a)", x = unit(1, "npc"),
y = unit(.95, "npc"))),
arrangeGrob(p2, left = textGrob("b)", x = unit(1, "npc"),
y = unit(.95, "npc"))),
arrangeGrob(p3, left = textGrob("c)", x = unit(1, "npc"),
y = unit(.95, "npc"))),
arrangeGrob(p4, left = textGrob("d)", x = unit(1, "npc"),
y = unit(.95, "npc"))))
??arrangeGrob
fig.2 <- gridExtra::grid.arrange(
gridExtra::arrangeGrob(p1, left = textGrob("a)", x = unit(1, "npc"),
y = unit(.95, "npc"))),
gridExtra::arrangeGrob(p2, left = textGrob("b)", x = unit(1, "npc"),
y = unit(.95, "npc"))),
gridExtra::arrangeGrob(p3, left = textGrob("c)", x = unit(1, "npc"),
y = unit(.95, "npc"))),
gridExtra::arrangeGrob(p4, left = textGrob("d)", x = unit(1, "npc"),
y = unit(.95, "npc"))))
fig.2 <- gridExtra::grid.arrange(
gridExtra::arrangeGrob(p1, left = gridExtra::textGrob("a)", x = unit(1, "npc"),
y = unit(.95, "npc"))),
gridExtra::arrangeGrob(p2, left = gridExtra::textGrob("b)", x = unit(1, "npc"),
y = unit(.95, "npc"))),
gridExtra::arrangeGrob(p3, left = gridExtra::textGrob("c)", x = unit(1, "npc"),
y = unit(.95, "npc"))),
gridExtra::arrangeGrob(p4, left = gridExtra::textGrob("d)", x = unit(1, "npc"),
y = unit(.95, "npc"))))
??textGrob
fig.2 <- gridExtra::grid.arrange(
gridExtra::arrangeGrob(p1, left = grid::textGrob("a)", x = unit(1, "npc"),
y = unit(.95, "npc"))),
gridExtra::arrangeGrob(p2, left = grid::textGrob("b)", x = unit(1, "npc"),
y = unit(.95, "npc"))),
gridExtra::arrangeGrob(p3, left = grid::textGrob("c)", x = unit(1, "npc"),
y = unit(.95, "npc"))),
gridExtra::arrangeGrob(p4, left = grid::textGrob("d)", x = unit(1, "npc"),
y = unit(.95, "npc"))))
?unit
fig.2 <- gridExtra::grid.arrange(
gridExtra::arrangeGrob(p1, left = grid::textGrob("a)", x = unit(1, "npc"),
y = grid::unit(.95, "npc"))),
gridExtra::arrangeGrob(p2, left = grid::textGrob("b)", x = unit(1, "npc"),
y = grid::unit(.95, "npc"))),
gridExtra::arrangeGrob(p3, left = grid::textGrob("c)", x = unit(1, "npc"),
y = grid::unit(.95, "npc"))),
gridExtra::arrangeGrob(p4, left = grid::textGrob("d)", x = unit(1, "npc"),
y = grid::unit(.95, "npc"))))
fig.2 <- gridExtra::grid.arrange(
gridExtra::arrangeGrob(p1, left = grid::textGrob("a)", x = grid::unit(1, "npc"),
y = grid::unit(.95, "npc"))),
gridExtra::arrangeGrob(p2, left = grid::textGrob("b)", x = grid::unit(1, "npc"),
y = grid::unit(.95, "npc"))),
gridExtra::arrangeGrob(p3, left = grid::textGrob("c)", x = grid::unit(1, "npc"),
y = grid::unit(.95, "npc"))),
gridExtra::arrangeGrob(p4, left = grid::textGrob("d)", x = grid::unit(1, "npc"),
y = grid::unit(.95, "npc"))))
primary.metabolome <- build.primary.metabolome(
pc.directory = local.pubchem.directory, get.properties = FALSE,
min.tax.ct = 2^8, keep.primary.only = TRUE)
pc.mw.prim <- ggplot2::ggplot(primary.metabolome, ggplot2::aes(monoisotopic.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000)) +
ggplot2::xlab("monoisotopic mass")
p4 <- pc.mw.prim
fig.2 <- gridExtra::grid.arrange(
gridExtra::arrangeGrob(p1, left = grid::textGrob("a)", x = grid::unit(1, "npc"),
y = grid::unit(.95, "npc"))),
gridExtra::arrangeGrob(p2, left = grid::textGrob("b)", x = grid::unit(1, "npc"),
y = grid::unit(.95, "npc"))),
gridExtra::arrangeGrob(p3, left = grid::textGrob("c)", x = grid::unit(1, "npc"),
y = grid::unit(.95, "npc"))),
gridExtra::arrangeGrob(p4, left = grid::textGrob("d)", x = grid::unit(1, "npc"),
y = grid::unit(.95, "npc"))))
ggplot2::ggsave(fig.2, file = paste0(out.dir, "mw.distribution.eps"), scale = 1.25)
pc.mw <- ggplot2::ggplot(cid.monoisotopic.mass, ggplot2::aes(exact.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000))
pc.mw <- ggplot2::ggplot(cid.monoisotopic.mass, ggplot2::aes(monoisotopic.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000))
pc.mw.bio <- ggplot2::ggplot(pc.bio, ggplot2::aes(monoisotopic.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000))
pc.mw.prim <- ggplot2::ggplot(primary.metabolome, ggplot2::aes(monoisotopic.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000)) +
ggplot2::xlab("monoisotopic mass")
p1 <- pc.mw
p2 <- pc.mw.bio
p3 <- pc.prim.curve
p4 <- pc.mw.prim
fig.2 <- gridExtra::grid.arrange(
gridExtra::arrangeGrob(p1, left = grid::textGrob("a)", x = grid::unit(1, "npc"),
y = grid::unit(.95, "npc"))),
gridExtra::arrangeGrob(p2, left = grid::textGrob("b)", x = grid::unit(1, "npc"),
y = grid::unit(.95, "npc"))),
gridExtra::arrangeGrob(p3, left = grid::textGrob("c)", x = grid::unit(1, "npc"),
y = grid::unit(.95, "npc"))),
gridExtra::arrangeGrob(p4, left = grid::textGrob("d)", x = grid::unit(1, "npc"),
y = grid::unit(.95, "npc"))))
ggplot2::ggsave(fig.2, file = paste0(out.dir, "mw.distribution.eps"), scale = 1.25)
packageVersion('pubchem.bio')
roxygen2::roxygenise(package.dir)
package.path <- "C:/Users/cbroeckl/Documents/GitHub/"
package.name <- "pubchem.bio"
package.dir <- paste0(package.path, package.name)
detach('package:pubchem.bio')
roxygen2::roxygenise(package.dir)
detach('package:pubchem.bio')
remotes::install_local(package.dir, dependencies = FALSE, force = TRUE)
devtools::check(package.dir)
local.pubchem.directory <- "C:/Temp/20250822"  ## i suggest this naming scheme, but feel free to chose your own.
data("pubchem.bio")
keep.cids <- pubchem.bio$cid
rm(pubchem.bio)
load(paste0(local.pubchem.directory, "pc.bio.Rdata"))
load(paste0(local.pubchem.directory, "pubchem.bio.Rdata"))
load(paste0(local.pubchem.directory, "/pubchem.bio.Rdata"))
load(paste0(local.pubchem.directory, "/pc.bio.Rdata"))
pubchem.bio <- pc.bio
pubchem.bio <- pubchem.bio[pubchem.bio$cid %in% keep.cids,]
dim(pubchem.bio)
save(pubchem.bio, file = "C:/Users/cbroeckl/Documents/GitHub/pubchem.bio/data/pubchem.bio.rda")
roxygen2::roxygenise(package.dir)
detach('package:pubchem.bio')
remotes::install_local(package.dir, dependencies = FALSE, force = TRUE)
devtools::check(package.dir)
source("C:/Users/cbroeckl/Documents/GitHub/pubchem.bio/R/build.primary.metabolome.R")
devtools::check_win_release(package.dir, email = 'cbroeckl@colostate.edu')
devtools::check(package.dir)
## push to CRAN
setwd(package.dir)
devtools::release(package.dir, check = FALSE)
load(paste0(local.pubchem.directory, "/cid.taxid.Rdata"))
dim(cid.taxid)
load(paste0(local.pubchem.directory, "/cid.pwid.Rdata"))
dim(cid.pwid)
n.mets
load(paste0(local.pubchem.directory, "/pc.bio.Rdata"))
load(paste0(local.pubchem.directory, "/cid.monoisotopic.mass.Rdata"))
pc.mw <- ggplot2::ggplot(cid.monoisotopic.mass, ggplot2::aes(monoisotopic.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000))
pc.mw.bio <- ggplot2::ggplot(pc.bio, ggplot2::aes(monoisotopic.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000))
pc.mw.prim <- ggplot2::ggplot(primary.metabolome, ggplot2::aes(monoisotopic.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000)) +
ggplot2::xlab("monoisotopic mass")
n.tax <- 2^(0:10)
n.mets <- rep(NA, length(n.tax))
for(i in 1:length(n.tax)) {
tmp <- build.primary.metabolome(
pc.directory = local.pubchem.directory, get.properties = FALSE,
min.tax.ct = n.tax[i], keep.primary.only = TRUE)
n.mets[i] <- nrow(tmp)
rm(tmp); gc()
}
primary.metabolome <- build.primary.metabolome(
pc.directory = local.pubchem.directory, get.properties = FALSE,
min.tax.ct = 2^8, keep.primary.only = TRUE)
pc.mw <- ggplot2::ggplot(cid.monoisotopic.mass, ggplot2::aes(monoisotopic.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000))
pc.mw.bio <- ggplot2::ggplot(pc.bio, ggplot2::aes(monoisotopic.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000))
pc.mw.prim <- ggplot2::ggplot(primary.metabolome, ggplot2::aes(monoisotopic.mass)) +
ggplot2::geom_density(color = "#000000", fill = "#1E4D2B", bw = 50) +
ggplot2::theme_classic() +
ggplot2::scale_x_continuous(limits = c(0, 2000)) +
ggplot2::xlab("monoisotopic mass")
rarefaction <- data.frame(
taxa.count = n.tax,
primary.metabolites = n.mets
)
pc.prim.curve <- ggplot2::ggplot(rarefaction, ggplot2::aes(x=taxa.count, y=primary.metabolites)) +
ggplot2::geom_line() +
ggplot2::geom_point(size=2) +
ggplot2::scale_x_continuous(
trans = "log2",
labels = scales::math_format(2^.x, format = log2)
) +
ggplot2::theme_classic()
p1 <- pc.mw
p2 <- pc.mw.bio
p3 <- pc.prim.curve
p4 <- pc.mw.prim
fig.2 <- gridExtra::grid.arrange(
gridExtra::arrangeGrob(p1, left = grid::textGrob("a)", x = grid::unit(1, "npc"),
y = grid::unit(.95, "npc"))),
gridExtra::arrangeGrob(p2, left = grid::textGrob("b)", x = grid::unit(1, "npc"),
y = grid::unit(.95, "npc"))),
gridExtra::arrangeGrob(p3, left = grid::textGrob("c)", x = grid::unit(1, "npc"),
y = grid::unit(.95, "npc"))),
gridExtra::arrangeGrob(p4, left = grid::textGrob("d)", x = grid::unit(1, "npc"),
y = grid::unit(.95, "npc"))))
ggplot2::ggsave(fig.2, file = paste0(out.dir, "mw.distribution.eps"), scale = 1.25)
out.dir
out.dir <- "C:/Users/cbroeckl/OneDrive - Colostate/ARC/manuscripts/20250721_pubchem.bio/"
ggpl <- ggplot2::ggplot(pc.bio.salsa, ggplot2::aes(taxonomy.lca.similarity.aggregate)) +
ggplot2::geom_histogram(color = "#000000", fill = "#1E4D2B") +
ggplot2::theme_classic()
pc.bio.salsa <- build.taxon.metabolome(taxid = c(4081, 4072, 4047, 4679, 4682), pc.directory = local.pubchem.directory, get.properties = FALSE)
ggpl <- ggplot2::ggplot(pc.bio.salsa, ggplot2::aes(taxonomy.lca.similarity.aggregate)) +
ggplot2::geom_histogram(color = "#000000", fill = "#1E4D2B") +
ggplot2::theme_classic()
ggplot2::ggsave(ggpl, file = paste0(out.dir, "salsa.score.histogram.eps"), scale = 0.75)
cids <- c(174174, 1548943) #atropine, capsaicin
cid.lca[cid.lca$cid %in% cids,]
load(paste0(local.pubchem.directory, "/cid.lca.Rdata"))
load(paste0(local.pubchem.directory, "/cid.taxid.Rdata"))
load(paste0(local.pubchem.directory, "/cid.monoisotopic.mass.Rdata"))
load(paste0(local.pubchem.directory, "/pc.bio.Rdata"))
cids <- c(174174, 1548943) #atropine, capsaicin
cid.lca[cid.lca$cid %in% cids,]
pc.prim.curve
ggplot2::ggsave(fig.2, file = paste0(out.dir, "mw.distribution.eps"), scale = 1.25)
